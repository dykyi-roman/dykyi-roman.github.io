<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dykyi Roman - Senior Software Engineer</title>
    <link rel="icon" href="icon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="resources/style.css">
    <link rel="stylesheet" href="resources/navigation.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
    <style>
        #map {
            height: 600px;
            width: 100%;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }

        .travel-stats {
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            color: white;
        }
        
        .total-countries {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .total-countries h4 {
            margin: 0;
            font-size: 1.5em;
            font-weight: 600;
        }
        
        .country-count {
            color: #FFD700;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .countries-by-continent {
            display: grid;
            gap: 20px;
        }
        
        .continent-group {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .continent-group h5 {
            margin: 0 0 15px 0;
            font-size: 1.2em;
            font-weight: 600;
            color: #FFD700;
        }
        
        .country-flags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .country-item {
            font-size: 2em;
            cursor: pointer;
            transition: transform 0.2s ease;
            display: inline-block;
        }
        
        .country-item:hover {
            transform: scale(1.2);
        }
        
        #map-controls {
            margin-bottom: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .map-filter-button {
            padding: 8px 15px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .map-filter-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .map-filter-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .custom-info-window {
            padding: 5px;
            max-width: 250px;
        }
        
        .info-location-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .info-continent {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 12px;
            margin-bottom: 5px;
            color: white;
        }
        
        .wishlist-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .wishlist-title {
            color: #FFD700;
            margin-bottom: 15px;
        }
        
        .wishlist-item {
            position: relative;
            display: inline-block;
            margin: 2px;
        }
        
        .wishlist-item .wish-icon {
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.8em;
            background: white;
            border-radius: 50%;
            padding: 1px;
        }
        
        .world-progress-section {
            margin-top: 20px;
        }

        .progress-title {
            color: #FFD700;
            margin-bottom: 15px;
        }

        .progress-bar {
            background-color: rgba(255, 255, 255, 0.3);
            height: 25px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            margin: 10px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #FFD700, #FFA500);
            height: 100%;
            width: 0%;
            transition: width 1.5s ease-in-out;
            border-radius: 15px;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }

        .progress-details {
            font-size: 1.1em;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .travel-stats {
                padding: 15px;
                margin-bottom: 20px;
            }

            .total-countries h4 {
                font-size: 1.3em;
            }

            .continent-group h5 {
                font-size: 1.1em;
            }

            .country-item {
                font-size: 1.8em;
            }

            .countries-by-continent {
                gap: 15px;
            }
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }

        [data-theme="dark"] .modal-content {
            background-color: #2a2a2a;
            border-color: #555;
            color: #fff;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
        }

        [data-theme="dark"] .modal-header {
            border-bottom-color: #555;
        }

        .modal-header h2 {
            margin: 0;
            color: #333;
        }

        [data-theme="dark"] .modal-header h2 {
            color: #fff;
        }

        .close-modal {
            cursor: pointer;
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #FFD700;
        }

        .country-flag-large {
            font-size: 64px;
            margin-bottom: 20px;
            text-align: center;
        }

        .country-info {
            margin-bottom: 20px;
        }

        .info-item {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #FFD700;
        }

        [data-theme="dark"] .info-item {
            background-color: #3a3a3a;
            color: #fff;
        }

        .info-item strong {
            font-weight: 600;
            color: #333;
        }

        [data-theme="dark"] .info-item strong {
            color: #FFD700;
        }

        #modal-highlights div {
            margin: 5px 0;
            padding-left: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Include header from external file -->
    <div id="header-container"></div>
    <script>
        fetch('headers.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
            })
            .catch(error => console.error('Error loading header:', error));
    </script>

    <!--  Travel  -->
    <div id="practice-section" class="section">
        <h3><i class="fas fa-plane"></i>Travel</h3>

        <!-- Countries Statistics -->
        <div class="travel-stats">
            <div class="total-countries">
                <h4><i class="fas fa-globe"></i> Total countries visited: <span class="country-count">0</span></h4>
            </div>

            <div class="countries-by-continent">
                <div class="continent-group">
                    <h5><i class="fas fa-mountain"></i> Asia</h5>
                    <div class="country-flags">
                    </div>
                </div>

                <div class="continent-group">
                    <h5><i class="fas fa-castle"></i> Europe</h5>
                    <div class="country-flags">
                    </div>
                </div>
            </div>

            <div class="wishlist-section">
                <h5 class="wishlist-title"><i class="fas fa-heart"></i> Wishlist Countries</h5>
                <div class="countries-by-continent">
                    <div class="continent-group">
                        <h5><i class="fas fa-globe"></i> Wishlist</h5>
                        <div class="country-flags">
                        </div>
                    </div>
                </div>
            </div>

            <div class="world-progress-section">
                <h5 class="progress-title"><i class="fas fa-chart-line"></i> World Exploration Progress</h5>
                <div class="world-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="world-progress-fill"></div>
                        <span class="progress-text" id="world-progress-text">0%</span>
                    </div>
                    <div class="progress-details">
                        <span id="visited-count">0</span> of <span id="total-world-countries">195</span> countries visited
                    </div>
                </div>
            </div>
        </div>

        <div id="map-controls">
            <button class="map-filter-button active" data-filter="all">All</button>
            <button class="map-filter-button" data-filter="asia">Asia</button>
            <button class="map-filter-button" data-filter="europe">Europe</button>
            <button class="map-filter-button" data-filter="wishlist">Wishlist</button>
        </div>

        <div id="map"></div>

        <!-- Country Details Modal -->
        <div id="country-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modal-country-name">Country Name</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="country-flag-large" id="modal-country-flag">🏳️</div>
                    <div class="country-info">
                        <div class="info-item">
                            <strong>Continent:</strong> <span id="modal-continent">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Visit Date:</strong> <span id="modal-visit-date">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Duration:</strong> <span id="modal-duration">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Rating:</strong> <span id="modal-rating">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Highlights:</strong>
                            <div id="modal-highlights">-</div>
                        </div>
                        <div class="info-item">
                            <strong>Notes:</strong>
                            <div id="modal-notes">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script src="resources/back-to-top.js"></script>
<script src="resources/navigation.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCboRvHNcHWuBFdV5ggCyMI-iz9W99k-Yg&callback=initMap&libraries=visualization" async defer></script>
<script>
    // Countries data with flags and continent grouping
    const countriesData = {
        asia: [
            { flag: '🇯🇵', name: 'Japan', visitDate: '2019-03', duration: '30 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Osaka', 'Kyoto', 'Tokyo', 'Fujinomiya', 'Yokohama', 'Nara'], notes: 'Amazing culture and technology blend' },
            { flag: '🇲🇴', name: 'Macao', visitDate: '2019-04', duration: '1 day', rating: '⭐⭐⭐⭐', highlights: ['Macau'], notes: 'Unique East-West fusion' },
            { flag: '🇭🇰', name: 'Hong Kong', visitDate: '2019-04', duration: '14 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Hong Kong'], notes: 'Incredible city energy' },
            { flag: '🇲🇻', name: 'Maldives', visitDate: '2020-02', duration: '30 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Male', 'Thoddoo', 'Ukulhas'], notes: 'Paradise on Earth' },
            { flag: '🇱🇰', name: 'Sri Lanka', visitDate: '2020-01', duration: '60 days', rating: '⭐⭐⭐⭐', highlights: ['Benthota', 'Unawatuna', 'Mount Lavinia', 'Kandy', 'Dambulla', 'Polonnaruwa', 'Pinnawala'], notes: 'Rich history and nature' },
            { flag: '🇳🇵', name: 'Nepal', visitDate: '2018-10', duration: '21 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Kathmandu'], notes: 'Life-changing trekking experience' },
            { flag: '🇮🇳', name: 'India', visitDate: '2018-09', duration: '30 days', rating: '⭐⭐⭐⭐', highlights: ['New Delhi', 'Jaipur', 'Varanasi', 'Agra', 'Goa'], notes: 'Incredible diversity and chaos' },
            { flag: '🇮🇩', name: 'Indonesia', visitDate: '2017-12', duration: '60 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Jakarta', 'Kuta', 'Ubud', 'Amed', 'Sanur'], notes: 'Island paradise with rich culture' },
            { flag: '🇵🇭', name: 'Philippines', visitDate: '2017-11', duration: '120 days', rating: '⭐⭐⭐⭐', highlights: ['Cebu City', 'Palawan', 'Puerto Princesa', 'Moalboal', 'Oslob', 'El Nido', 'Coron', 'Boracay', 'Panglao', 'Manila', 'Bohol'], notes: 'Beautiful islands and friendly people' },
            { flag: '🇹🇭', name: 'Thailand', visitDate: '2017-10', duration: '360 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Bangkok', 'Phuket', 'Phi Phu', 'Pattaya', 'Chiang Mai', 'Krabi', 'Koh Samui', 'Koh Pha Ngan', 'Koh Nang'], notes: 'Perfect backpacking destination' },
            { flag: '🇱🇦', name: 'Laos', visitDate: '2017-09', duration: '30 days', rating: '⭐⭐⭐⭐', highlights: ['Vientiane', 'Luang Prabang', 'Vang Vieng'], notes: 'Peaceful and authentic' },
            { flag: '🇻🇳', name: 'Vietnam', visitDate: '2017-08', duration: '30 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Hanoi', 'Da Nang', 'Hội An'], notes: 'Amazing food and landscapes' },
            { flag: '🇰🇭', name: 'Cambodia', visitDate: '2017-07', duration: '21 days', rating: '⭐⭐⭐⭐', highlights: ['Siem Reap', 'Phnom Penh'], notes: 'Rich Khmer heritage' },
            { flag: '🇸🇬', name: 'Singapore', visitDate: '2017-06', duration: '4 days', rating: '⭐⭐⭐⭐', highlights: ['Singapore'], notes: 'Modern city-state perfection' },
            { flag: '🇲🇾', name: 'Malaysia', visitDate: '2017-05', duration: '70 days', rating: '⭐⭐⭐⭐', highlights: ['Kuala Lumpur'], notes: 'Great cultural diversity' },
            { flag: '🇦🇪', name: 'UAE', visitDate: '2016-12', duration: '21 days', rating: '⭐⭐⭐⭐', highlights: ['Dubai', 'Abu Dhabi'], notes: 'Modern Arabian dream' },
            { flag: '🇮🇱', name: 'Israel', visitDate: '2016-08', duration: '14 days', rating: '⭐⭐⭐⭐', highlights: ['Jerusalem', 'Tel Aviv-Yafo', 'Haifa'], notes: 'Historical and spiritual journey' },
            { flag: '🇹🇷', name: 'Turkey', visitDate: '2016-07', duration: '14 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Istanbul'], notes: 'Bridge between Europe and Asia' },
            { flag: '🇬🇪', name: 'Georgia', visitDate: '2015-09', duration: '360 days', rating: '⭐⭐⭐⭐', highlights: ['Kutaisi', 'Batumi', 'Tbilisi', 'Borjomi', 'Mestia'], notes: 'Hidden gem with great hospitality' },
            { flag: '🇦🇿', name: 'Azerbaijan', visitDate: '2015-08', duration: '10 days', rating: '⭐⭐⭐', highlights: ['Baku'], notes: 'Land of fire and oil' },
        ],
        europe: [
            { flag: '🇧🇾', name: 'Belarus', visitDate: '2021-06', duration: '7 days', rating: '⭐⭐⭐', highlights: ['Minsk'], notes: 'Last dictatorship of Europe' },
            { flag: '🇵🇱', name: 'Poland', visitDate: '2021-05', duration: '30 days', rating: '⭐⭐⭐⭐', highlights: ['Warsaw', 'Kraków', 'Wrocław'], notes: 'Rich history and culture' },
            { flag: '🇱🇹', name: 'Lithuania', visitDate: '2021-04', duration: '5 days', rating: '⭐⭐⭐⭐', highlights: ['Vilnius'], notes: 'Beautiful Baltic state' },
            { flag: '🇱🇻', name: 'Latvia', visitDate: '2021-03', duration: '1000 days', rating: '⭐⭐⭐', highlights: ['Riga', 'Jūrmala'], notes: 'Charming medieval city' },
            { flag: '🇪🇪', name: 'Estonia', visitDate: '2021-02', duration: '1 days', rating: '⭐⭐⭐⭐', highlights: ['Tallinn'], notes: 'Most digital country' },
            { flag: '🇫🇮', name: 'Finland', visitDate: '2020-12', duration: '10 days', rating: '⭐⭐⭐⭐', highlights: ['Helsinki', 'Rovaniemi'], notes: 'Land of thousand lakes' },
            { flag: '🇸🇪', name: 'Sweden', visitDate: '2020-11', duration: '1 days', rating: '⭐⭐⭐⭐', highlights: ['Stockholm'], notes: 'Scandinavian perfection' },
            { flag: '🇩🇪', name: 'Germany', visitDate: '2019-10', duration: '30 days', rating: '⭐⭐⭐⭐', highlights: ['Berlin', 'Frankfurt am Main'], notes: 'Efficient and historical' },
            { flag: '🇦🇹', name: 'Austria', visitDate: '2019-09', duration: '7 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Vienna'], notes: 'Musical and mountainous' },
            { flag: '🇨🇿', name: 'Czech Republic', visitDate: '2019-08', duration: '14 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Prague', 'Pilzen'], notes: 'Fairy tale architecture' },
            { flag: '🇫🇷', name: 'France', visitDate: '2019-07', duration: '7 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Paris'], notes: 'Art, culture, and cuisine' },
            { flag: '🇮🇹', name: 'Italy', visitDate: '2019-06', duration: '60 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Milan', 'Treviso', 'Bologna', 'Florence', 'Venice', 'Rimini'], notes: 'Renaissance and romance' },
            { flag: '🇳🇱', name: 'Netherlands', visitDate: '2019-05', duration: '7 days', rating: '⭐⭐⭐⭐', highlights: ['Amsterdam', 'Rotterdam'], notes: 'Liberal and flat' },
            { flag: '🇸🇲', name: 'San Marino', visitDate: '2019-06', duration: '1 day', rating: '⭐⭐⭐', highlights: ['San Marino'], notes: 'Tiny mountain republic' },
            { flag: '🇬🇷', name: 'Greece', visitDate: '2018-08', duration: '14 days', rating: '⭐⭐⭐⭐⭐', highlights: ['Athens', 'Kalampaka', 'Santorini'], notes: 'Cradle of civilization' },
            { flag: '🇧🇪', name: 'Belgium', visitDate: '2018-07', duration: '7 days', rating: '⭐⭐⭐⭐', highlights: ['Brussels'], notes: 'Waffles and medieval charm' },
            { flag: '🇭🇺', name: 'Hungary', visitDate: '2018-06', duration: '7 days', rating: '⭐⭐⭐⭐', highlights: ['Budapest'], notes: 'Pearl of the Danube' }
        ],
    };

    // Wishlist countries - places to visit in the future
    const wishlistCountries = {
        africa: [
            { flag: '🇪🇬', name: 'Egypt', wishIcon: '🌟' },
            { flag: '🇲🇬', name: 'Madagascar', wishIcon: '🌟' },
            { flag: '🇲🇺', name: 'Mauritius', wishIcon: '🌟' },
            { flag: '🇹🇿', name: 'Tanzania', wishIcon: '🌟' },
            { flag: '🇰🇪', name: 'Kenya', wishIcon: '🌟' },
            { flag: '🇪🇹', name: 'Ethiopia', wishIcon: '🌟' },
            { flag: '🇸🇦', name: 'Socotra', wishIcon: '🌟' }
        ],
        asia: [
            { flag: '🇶🇦', name: 'Qatar', wishIcon: '🌟' },
            { flag: '🇨🇳', name: 'China', wishIcon: '🌟' },
            { flag: '🇰🇷', name: 'South Korea', wishIcon: '🌟'},
            { flag: '🇾🇪', name: 'Yamen', wishIcon: '🌟' },
        ],
        oceania: [
            { flag: '🇵🇬', name: 'Papua New Guinea', wishIcon: '🌟' },
            { flag: '🇦🇺', name: 'Australia', wishIcon: '🌟' },
            { flag: '🇳🇿', name: 'New Zealand', wishIcon: '🌟' }
        ],
        america: [
            { flag: '🇨🇦', name: 'Canada', wishIcon: '🌟' },
            { flag: '🇺🇸', name: 'USA', wishIcon: '🌟' }
        ],
        'latin-america': [
            { flag: '🇧🇷', name: 'Brazil', wishIcon: '🌟' },
            { flag: '🇦🇷', name: 'Argentina', wishIcon: '🌟' },
            { flag: '🇨🇱', name: 'Chile', wishIcon: '🌟' },
            { flag: '🇨🇴', name: 'Colombia', wishIcon: '🌟' },
            { flag: '🇻🇪', name: 'Venezuela', wishIcon: '🌟' },
            { flag: '🇵🇦', name: 'Panama', wishIcon: '🌟' },
            { flag: '🇲🇽', name: 'Mexico', wishIcon: '🌟' },
            { flag: '🇬🇹', name: 'Guatemala', wishIcon: '🌟' },
            { flag: '🇵🇪', name: 'Peru', wishIcon: '🌟' },
            { flag: '🇪🇨', name: 'Ecuador', wishIcon: '🌟' },
            { flag: '🇧🇴', name: 'Bolivia', wishIcon: '🌟' },
            { flag: '🇨🇺', name: 'Cuba', wishIcon: '🌟' },
            { flag: '🇵🇷', name: 'Puerto Rico', wishIcon: '🌟' },
        ]
    };

    // Calculate total countries count
    function getTotalCountriesCount() {
        return countriesData.asia.length + countriesData.europe.length;
    }

    // Calculate total wishlist countries count
    function getTotalWishlistCount() {
        return Object.values(wishlistCountries).reduce((total, continent) => total + continent.length, 0);
    }

    // Update countries display
    function updateCountriesDisplay() {
        // Update total count
        const totalCount = getTotalCountriesCount();
        const wishlistCount = getTotalWishlistCount();
        document.querySelector('.country-count').textContent = totalCount;

        // Update continent counts
        document.querySelector('.continent-group:nth-child(1) h5').innerHTML =
            `<i class="fas fa-mountain"></i> Asia (${countriesData.asia.length} countries)`;
        document.querySelector('.continent-group:nth-child(2) h5').innerHTML =
            `<i class="fa-solid fa-chess-rook"></i></i> Europe (${countriesData.europe.length} countries)`;

        // Update wishlist count
        document.querySelector('.wishlist-section .continent-group h5').innerHTML =
            `<i class="fas fa-globe"></i> Wishlist (${wishlistCount} countries)`;

        // Update country flags
        const asiaFlags = document.querySelector('.continent-group:nth-child(1) .country-flags');
        const europeFlags = document.querySelector('.continent-group:nth-child(2) .country-flags');

        asiaFlags.innerHTML = countriesData.asia.map(country =>
            `<span class="country-item" title="${country.name}" data-continent="Asia" data-visit-date="${country.visitDate}" data-duration="${country.duration}" data-rating="${country.rating}" data-highlights="${country.highlights.join(', ')}" data-notes="${country.notes}">${country.flag}</span>`
        ).join('');

        europeFlags.innerHTML = countriesData.europe.map(country =>
            `<span class="country-item" title="${country.name}" data-continent="Europe" data-visit-date="${country.visitDate}" data-duration="${country.duration}" data-rating="${country.rating}" data-highlights="${country.highlights.join(', ')}" data-notes="${country.notes}">${country.flag}</span>`
        ).join('');

        // Wishlist countries
        const wishlistFlags = document.querySelector('.wishlist-section .country-flags');
        wishlistFlags.innerHTML = Object.values(wishlistCountries).flat().map(country =>
            `<span class="wishlist-item" title="${country.name}">${country.flag}<span class="wish-icon">${country.wishIcon}</span></span>`
        ).join('');

        // Update world exploration progress
        const visitedCount = totalCount;
        const totalWorldCountries = 195;
        const progressPercentage = (visitedCount / totalWorldCountries) * 100;
        document.getElementById('world-progress-fill').style.width = `${progressPercentage}%`;
        document.getElementById('world-progress-text').textContent = `${progressPercentage.toFixed(1)}%`;
        document.getElementById('visited-count').textContent = visitedCount;
        document.getElementById('total-world-countries').textContent = totalWorldCountries;

        // Add event listeners to country flags after they are created
        setTimeout(() => {
            addCountryClickListeners();
        }, 100);
    }

    // Function to add click listeners to country flags
    function addCountryClickListeners() {
        const countryFlags = document.querySelectorAll('.country-item');
        countryFlags.forEach(flag => {
            flag.addEventListener('click', () => {
                const countryName = flag.title;
                const continent = flag.getAttribute('data-continent');
                const visitDate = flag.getAttribute('data-visit-date');
                const duration = flag.getAttribute('data-duration');
                const rating = flag.getAttribute('data-rating');
                const highlights = flag.getAttribute('data-highlights').split(', ');
                const notes = flag.getAttribute('data-notes');

                // Update modal content
                document.getElementById('modal-country-name').textContent = countryName;
                document.getElementById('modal-country-flag').textContent = flag.textContent;
                document.getElementById('modal-continent').textContent = continent;
                document.getElementById('modal-visit-date').textContent = visitDate;
                document.getElementById('modal-duration').textContent = duration;
                document.getElementById('modal-rating').textContent = rating;
                document.getElementById('modal-highlights').innerHTML = highlights.map(highlight => `<div>• ${highlight}</div>`).join('');
                document.getElementById('modal-notes').textContent = notes;

                // Show modal
                document.getElementById('country-modal').style.display = 'block';
            });
        });
    }

    // Initialize countries display when page loads
    document.addEventListener('DOMContentLoaded', function() {
        updateCountriesDisplay();

        // Add event listener to close modal
        document.querySelector('.close-modal').addEventListener('click', () => {
            document.getElementById('country-modal').style.display = 'none';
        });

        // Close modal when clicking outside of it
        window.addEventListener('click', (event) => {
            const modal = document.getElementById('country-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });
    });

    function initMap() {
        // Custom map style - travel themed
        const mapStyles = [
            {
                "featureType": "administrative",
                "elementType": "labels.text.fill",
                "stylers": [{"color": "#444444"}]
            },
            {
                "featureType": "landscape",
                "elementType": "all",
                "stylers": [{"color": "#f2f2f2"}]
            },
            {
                "featureType": "poi",
                "elementType": "all",
                "stylers": [{"visibility": "off"}]
            },
            {
                "featureType": "road",
                "elementType": "all",
                "stylers": [{"saturation": -100}, {"lightness": 45}]
            },
            {
                "featureType": "road.highway",
                "elementType": "all",
                "stylers": [{"visibility": "simplified"}]
            },
            {
                "featureType": "road.arterial",
                "elementType": "labels.icon",
                "stylers": [{"visibility": "off"}]
            },
            {
                "featureType": "transit",
                "elementType": "all",
                "stylers": [{"visibility": "off"}]
            },
            {
                "featureType": "water",
                "elementType": "all",
                "stylers": [{"color": "#a3ccff"}, {"visibility": "on"}]
            }
        ];

        const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 2,
            center: { lat: 20, lng: 0 },
            styles: mapStyles,
            mapTypeControl: false,
            fullscreenControl: true,
            streetViewControl: false,
            zoomControlOptions: {
                position: google.maps.ControlPosition.RIGHT_TOP
            }
        });

        const locations = {
            "Ukraine": [
                { lat: 46.4749082, lng: 30.7287808, title: "Odessa, Bazarna 104" },
                { lat: 50.5101285, lng: 30.5001186, title: "Kyiv, Obolonska avenue 16a" },
            ],
            "Belarus": [
                { lat: 53.9000000, lng: 27.5666667, title: "Minsk, Gorky avenue 1" },
            ],
            "San Marino": [
                { lat: 43.9423601, lng: 12.4577739, title: "San Marino, Via del Ponte" },
            ],
            "India": [
                { lat: 28.6183389, lng: 77.2142565, title: "New Delhi, Travel by Couch-surfing" },
                { lat: 26.9130762, lng: 75.792761, title: "Jaipur" },
                { lat: 25.3207397, lng: 82.9087067, title: "Varanasi, Travel by bus" },
                { lat: 27.1761504, lng: 77.8976108, title: "Agra, Travel by Couch-surfing" },
                { lat: 15.5355982, lng: 73.7620102, title: "Goa, Calangute, Home in Calangute" },
            ],
            "Greece": [
                { lat: 37.9659202, lng: 23.7441294, title: "Athens, Pagrati" },
                { lat: 37.9575197, lng: 23.7207616, title: "Athens, Loid Tzortz Guest House" },
                { lat: 39.7074472, lng: 21.6214896, title: "Kalampaka, Aeolic Star Hotel" },
                { lat: 36.4203258, lng: 25.4218707, title: "Santorini, Santorini Camping & Hostel" },
            ],
            'Finland': [
                { lat: 60.1657988, lng: 24.9673356, title: "Helsinki, Eurohostel" },
                { lat: 66.5048301, lng: 25.716365, title: "Rovaniemi, GuestHouse Arctic Heart" },
            ],
            "Maldives": [
                { lat: 3.202778, lng: 73.220833, title: "Male, Travel by ship" },
                { lat: 4.4360125, lng: 72.9576381, title: "Thoddoo, Evila Inn - Thoddoo" },
                { lat: 4.2148307, lng: 72.8613765, title: "Ukulhas, Home in Kulhas" }, // ???
            ],
            "Turkey": [
                { lat: 41.0115158, lng: 28.9431013, title: "Istanbul, Home in Fatih" },
                // { lat: 41.0063429, lng: 28.9661672, title: "Istanbul, Le Valeria Deluxe"},
            ],
            "Latvia": [
                { lat: 56.9348137, lng: 24.0352716, title: "Riga, Kalnciema Iella 135" },
                { lat: 56.950761, lng: 24.1277996, title: "Riga, Avotu Iella 6" },
                { lat: 56.9667375, lng: 23.5573685, title: "Jūrmala, Travel by train" },
            ],
            "Lithuania": [
                { lat: 54.6831074, lng: 25.2883817, title: "Vilnius, Home in Vilnius" },
                { lat: 54.6723695, lng: 25.2784091, title: "Vilnius, Hostel Oras" },
            ],
            "Netherlands": [
                { lat: 52.3343232, lng: 4.950593, title: "Amsterdam, Summer Suites Bernice" },
                { lat: 51.9215708, lng: 4.4539677, title: "Rotterdam" },
            ],
            "Italy": [
                { lat: 45.4627042, lng: 9.0953311, title: "Milan" },
                { lat: 45.6622584, lng: 12.2336997, title: "Treviso"},
                { lat: 44.4965262, lng: 11.3329664, title: "Bologna"},
                { lat: 43.7710583, lng: 11.2501702, title: "Florence"},
                { lat: 45.4390869, lng: 12.3344736, title: "Venice, Residenza Grisostomo"},
                { lat: 44.061159, lng: 12.5820507, title: "Rimini, Hotel Jana"},
            ],
            "Israel": [
                { lat: 31.7838176, lng: 35.209266, title: "Jerusalem, Home in Jerusalem" },
                { lat: 32.0708739, lng: 34.7624001, title: "Tel Aviv-Yafo, Gold Sea Hostel" },
                { lat: 32.7996157, lng: 34.9755762, title: "Haifa, Travel by bus" },
            ],
            "Georgia": [
                { lat: 42.2684883, lng: 42.7062823, title: "Kutaisi" },
                { lat: 41.6393818, lng: 41.6115515, title: "Batumi, Orbi Twin Towers" },
                { lat: 41.643333, lng: 41.625653, title: "Batumi, 38 Takaishvili Str" },
                { lat: 41.7006091, lng: 44.7976594, title: "Tbilisi" },
                { lat: 41.8383178, lng: 43.3872417, title: "Borjomi" },
                { lat: 43.0448858, lng: 42.7239988, title: "Mestia" },
            ],
            "Azerbaijan": [
                { lat: 40.3736538, lng: 49.8333648, title: "Baku" },
            ],
            "UAE": [
                { lat: 25.1927589, lng: 55.27857342, title: "Dubai, Millennium Central Downtown"},
                { lat: 24.4225781, lng: 54.4551371, title: "Abu Dhabi, Millennium Al Rawdah Hotel"},
            ],
            "Nepal": [
                { lat: 27.6731487, lng: 85.4265879, title: "Kathmandu, Tulaja Boutique Hotel" },
                { lat: 27.7150956, lng: 85.3114999, title: "Kathmandu, Oasis Kathmandu Hotel" },
            ],
            "Malaysia": [
                { lat: 3.1589606, lng: 101.7026803, title: "Kuala Lumpur, Summer Suites Bernice" },
                { lat: 3.1559413, lng: 101.7084828, title: "Kuala Lumpur, Park view" },
                { lat: 3.1566564, lng: 101.7066367, title: "Kuala Lumpur, Sky Suites by Lynn" },
                { lat: 2.239658, lng: 102.2075049, title: "Malacca, Travel by bus" },
            ],
            "Thailand": [
                { lat: 13.7674467, lng: 100.6390582, title: "Bangkok, Khet Bang Kapi" },
                { lat: 13.7419321, lng: 100.508378, title: "Bangkok, Khet Samphanthawong" },
                { lat: 13.7588358, lng: 100.505161, title: "Bangkok, Alameda Suites" },
                { lat: 7.8874916, lng: 98.3003037, title: "Phuket, Pa Tong" },
                { lat: 7.7407571, lng: 98.7749888, title: "Phi Phu, Valentines Bungalow" },
                { lat: 12.0024527, lng: 120.2060122, title: "Pattaya, Home in Pattaya City" },
                { lat: 12.932119, lng: 100.8814636, title: "Pattaya, Beach" },
                { lat: 18.7829125, lng: 98.9966371, title: "Chiang Mai, Phra Sing" },
                { lat: 8.033644, lng: 98.8296906, title: "Krabi, Ao Nang, La Belle" },
                { lat: 8.0342885, lng: 98.8267155, title: "Krabi, Ao Nang, Monotel" },
                { lat: 8.0387975, lng: 98.8198457, title: "Krabi, Ao Nang, The Rocco Ao-Nang Krabi" },
                { lat: 8.0128819, lng: 98.8421495, title: "Krabi, Railay Bay, Diamond Cave Resort"},
                { lat: 9.5542579, lng: 100.029924, title: "Koh Samui" },
                { lat: 9.458672, lng: 100.0305871, title: "Koh Samui, Lamai Viewpoint"},
                { lat: 9.7026519, lng: 100.0106684, title: "Koh Pha Ngan, The Cosy Sunset Beach Resort & Restaurant"},
                { lat: 10.0981192, lng: 99.8290426, title: "Koh Tao, Home in Koh Tao"},
                { lat: 10.1166193, lng: 99.8138068, title: "Koh Nang, Koh Nang Yuan Viewpoint"},
                { lat: 13.7244415, lng: 100.562694, title: "Bangkok, The Emporio Place"},
                { lat: 13.7118771, lng: 100.6062321, title: "Bangkok, Home in Khet Suan Luang"},
            ],
            "Japan": [
                { lat: 34.6734763, lng: 135.5228785, title: "Osaka, Home in Osaka"},
                { lat: 34.9945252, lng: 135.7568764, title: "Kyoto, Super Hotel Kyoto Karasuma Gojo"},
                { lat: 35.7039206, lng: 139.7948724, title: "Tokyo, HOTEL MYSTAYS Asakusa"},
                { lat: 35.3606246, lng: 138.7170637, title: "Fujinomiya, Mount fuji"},
                { lat: 35.446711, lng: 139.6515033, title: "Yokohama, The Gundam Factory Yokohama"},
                { lat: 34.685047, lng: 135.8404371, title: "Nara, Park Nara"},
            ],
            "Hong Kong": [
                { lat: 22.321771, lng: 114.1675655, title: "Hong Kong"},
            ],
            "Philippines": [
                { lat: 10.3329783, lng: 123.9073145, title: "Cebu City, Avida Towers" },
                { lat: 10.3166272, lng: 119.3414294, title: "Palawan, Ocean Manor Inn" },
                { lat: 9.7394999, lng: 118.7313656, title: "Puerto Princesa, Mariner's Pension House" },
                { lat: 9.9525364, lng: 123.3660057, title: "Moalboal, Dolce Vita Resort" },
                { lat: 9.5221595, lng: 123.4288375, title: "Oslob, Luna Oslob Travellers Inn" },
                { lat: 11.1827228, lng: 119.3927341, title: "El Nido, Silverise Pension" },
                { lat: 12.0024527, lng: 120.2060122, title: "Coron, Ina HomeStay" },
                { lat: 11.9523585, lng: 121.9295729, title: "Boracay, White Bitch" },
                { lat: 9.5517335, lng: 123.7746862, title: "Panglao" },
                { lat: 9.5632636, lng: 123.8035985, title: "Panglao, Tyner's Place" },
                { lat: 14.5624157, lng: 120.9908138, title: "Manila, Century Park Hotel" },
                { lat: 9.8297076, lng: 124.1293758, title: "Bohol, Chocolate Hills, Travel by car" },
            ],
            "Singapore": [
                { lat: 1.2985179, lng: 103.8548296, title: "Singapore, The Snooze Hotel at Bugis" },
            ],
            "Indonesia": [
                { lat: -8.3350301, lng: 115.6476298, title: "Bali(Amed), Home in Abang" },
                { lat: -8.7038072, lng: 115.2537278, title: "Bali(Sanur), Denpasar Selatan" },
                { lat: -6.1967763, lng: 106.8154447, title: "Jakarta, Thamrin Executive Residence" },
                { lat: -6.1185777, lng: 106.6874956, title: "Jakarta, Benda" },
                { lat: -6.1529539, lng: 106.8178944, title: "Jakarta, RedDoorz near Hayam Wuruk Plaza" },
                { lat: -8.7205673, lng: 115.1696496, title: "Bali(Kuta), OYO 4012 Ari Beach Inn" },
                { lat: -8.5032796, lng: 115.2640809, title: "Bali(Ubud), Kertayasa house" },
            ],
            "Vietnam": [
                { lat: 21.0276262, lng: 105.8346467, title: "Hanoi" },
                { lat: 16.0513323, lng: 108.2405212, title: "Da Nang" },
                { lat: 15.8827741, lng: 108.3371248, title: "Hội An" },
            ],
            "Laos": [
                { lat: 17.9678224, lng: 102.6011228, title: "Vientiane" },
                { lat: 19.8845625, lng: 102.1328626, title: "Luang Prabang, Chaliya Boutique Garden" },
                { lat: 18.928473, lng: 102.4452279, title: "Vang Vieng, Bountang Mountain View Riverside Hotel" },
            ],
            "Cambodia": [
                { lat: 13.3524143, lng: 103.8547441, title: "Siem Reap, Krong Siem Reap" },
                { lat: 11.5510929, lng: 104.9204016, title: "Phnom Penh, SKY Residence" },
            ],
            "Sri Lanka": [
                { lat: 6.4225108, lng: 79.9975638, title: "Benthota, Home in Bentota" },
                { lat: 6.0098045, lng: 80.2482118, title: "Unawatuna, Home in Unawatuna" },
                { lat: 6.8424305, lng: 79.8638464, title: "Mount Lavinia, Self order" },
                { lat: 7.2874413, lng: 80.6394468, title: "Kandy, Kandy IVY Banks Holiday Resort" },
                { lat: 7.8736801, lng: 80.6466919, title: "Dambulla, Gamagedara Resort" },
                { lat: 7.9407759, lng: 81.0153238, title: "Polonnaruwa, Thisal Guest House" },
                { lat: 6.8413057, lng: 79.8620323, title: "Mount Lavinia, Ranveli Beach Resort" },
                { lat: 7.2998006, lng: 80.3825923, title: "Pinnawala, Hotel Elephant Bay" },
            ],
            "Kazakhstan": [
                // { lat: 43.2598898, lng: 76.9330709, title: "Astana, Apartment in Almaty"},
            ],
            "Uzbekistan": [
                // { lat: 41.3086111, lng: 69.2665918, title: "Tashkent, City Centre Hotel"},
                // { lat: 39.6567259, lng: 66.9707512, title: "Samarkand, City Centre Hotel"},
                // { lat: 39.7774923, lng: 64.4204554, title: "Bukhara, Travel by train"},
            ],
            "Spain": [
                // { lat: 41.377071, lng: 2.1504022, title: "Barcelona, Home in Barcelona"},
                // { lat: 39.4739172, lng: -0.3646948, title: "Valencia, Home in Valencia"},
            ],
            "Macao": [
                { lat: 22.1903224, lng: 113.543226, title: "Macau, Travel by ship" },
            ],
            "Poland": [
                { lat: 52.2296756, lng: 21.0122287, title: "Warsaw" }, // ???
                { lat: 50.0639797, lng: 19.9405603, title: "Kraków" }, // ???
                { lat: 51.1119111, lng: 17.0246375, title: "Wrocław" }, // ???
            ],
            "Estonia": [
                { lat: 58.380259, lng: 26.7205862, title: "Tallinn, Travel by bus" },
            ],
            "Sweden": [
                { lat: 59.3329783, lng: 18.9073145, title: "Stockholm, Home in Stockholm" },
            ],
            "Germany": [
                { lat: 52.520008, lng: 13.404954, title: "Berlin" }, // ???
                { lat: 50.1203354, lng: 8.6734046, title: "Frankfurt am Main" }, // ???
            ],
            "Austria": [
                { lat: 48.2081749, lng: 16.3738199, title: "Vienna" }, // ???
            ],
            "Czech Republic": [
                { lat: 50.0755391, lng: 14.4378, title: "Prague, Home in Prague" },
                { lat: 49.7448685, lng: 13.3767192, title: "Pilzen, Home in Pilzen" },
            ],
            "France": [
                { lat: 48.856614, lng: 2.3522219, title: "Paris, Travel by Couch-surfing" },
            ],
            "Belgium": [
                { lat: 50.85034, lng: 4.35171, title: "Brussels, Travel by Couch-surfing" },
            ],
            "Hungary": [
                { lat: 47.498, lng: 19.0402, title: "Budapest" },
            ],
            'Yemen': [
                { lat: 12.5063988, lng: 53.2603338, title: "Socotra (Wishlist)", wishlist: true},
            ],
            "Egypt": [
                { lat: 30.0444196, lng: 31.2357116, title: "Cairo (Wishlist)", wishlist: true},
            ],
            "Madagascar": [
                { lat: -18.8791902, lng: 47.5079055, title: "Antananarivo (Wishlist)", wishlist: true},
            ],
            "Mauritius": [
                { lat: -20.348404, lng: 57.552152, title: "Port Louis (Wishlist)", wishlist: true},
            ],
            "Tanzania": [
                { lat: -6.792354, lng: 39.208328, title: "Dar es Salaam (Wishlist)", wishlist: true},
            ],
            "Kenya": [
                { lat: -1.292066, lng: 36.821946, title: "Nairobi (Wishlist)", wishlist: true},
            ],
            "Ethiopia": [
                { lat: 9.145, lng: 40.489673, title: "Addis Ababa (Wishlist)", wishlist: true},
            ],
            "Qatar": [
                { lat: 25.276987, lng: 51.520008, title: "Doha (Wishlist)", wishlist: true},
            ],
            "China": [
                { lat: 39.904211, lng: 116.407395, title: "Beijing (Wishlist)", wishlist: true},
            ],
            "South Korea": [
                { lat: 37.566535, lng: 126.9779692, title: "Seoul (Wishlist)", wishlist: true},
            ],
            "Papua New Guinea": [
                { lat: -9.4438, lng: 147.1803, title: "Port Moresby (Wishlist)", wishlist: true},
            ],
            "Australia": [
                { lat: -33.8688, lng: 151.2093, title: "Sydney (Wishlist)", wishlist: true},
            ],
            "New Zealand": [
                { lat: -36.8485, lng: 174.7633, title: "Auckland (Wishlist)", wishlist: true},
            ],
            "Canada": [
                { lat: 45.5017, lng: -73.5673, title: "Montreal (Wishlist)", wishlist: true},
            ],
            "USA": [
                { lat: 40.7128, lng: -74.0060, title: "New York (Wishlist)", wishlist: true},
            ],
            "Brazil": [
                { lat: -22.9068, lng: -43.1729, title: "Rio de Janeiro (Wishlist)", wishlist: true},
            ],
            "Argentina": [
                { lat: -34.6118, lng: -58.3960, title: "Buenos Aires (Wishlist)", wishlist: true},
            ],
            "Chile": [
                { lat: -33.4489, lng: -70.6693, title: "Santiago (Wishlist)", wishlist: true},
            ],
            "Colombia": [
                { lat: 4.7110, lng: -74.0721, title: "Bogotá (Wishlist)", wishlist: true},
            ],
            "Venezuela": [
                { lat: 10.4806, lng: -66.9036, title: "Caracas (Wishlist)", wishlist: true},
            ],
            "Panama": [
                { lat: 8.9824, lng: -79.5199, title: "Panama City (Wishlist)", wishlist: true},
            ],
            "Mexico": [
                { lat: 19.4326, lng: -99.1332, title: "Mexico City (Wishlist)", wishlist: true},
            ],
            "Guatemala": [
                { lat: 14.6349, lng: -90.5069, title: "Guatemala City (Wishlist)", wishlist: true},
            ],
            "Peru": [
                { lat: -12.0464, lng: -77.0428, title: "Lima (Wishlist)", wishlist: true},
            ],
            "Ecuador": [
                { lat: -0.1807, lng: -78.4678, title: "Quito (Wishlist)", wishlist: true},
            ],
            "Bolivia": [
                { lat: -16.2902, lng: -63.5887, title: "Santa Cruz (Wishlist)", wishlist: true},
            ],
            "Cuba": [
                { lat: 23.1136, lng: -82.3666, title: "Havana (Wishlist)", wishlist: true},
            ],
            "Puerto Rico": [
                { lat: 18.4655, lng: -66.1057, title: "San Juan (Wishlist)", wishlist: true},
            ],
        };

        // Build continent mapping dynamically from countries in locations
        const continentMapping = {};
        
        // Define continent for each country that exists in locations
        const countryToContinentMap = {
            "Finland": "europe",
            "Ukraine": "europe",
            "Belarus": "europe", 
            "San Marino": "europe",
            "Greece": "europe",
            "Latvia": "europe",
            "Lithuania": "europe",
            "Netherlands": "europe",
            "Italy": "europe",
            "Spain": "europe",
            "Poland": "europe",
            "Estonia": "europe",
            "Sweden": "europe",
            "Germany": "europe",
            "Austria": "europe",
            "Czech Republic": "europe",
            "France": "europe",
            "Belgium": "europe",
            "Hungary": "europe",
            "UAE": "asia",
            "Nepal": "asia",
            "India": "asia",
            "Japan": "asia",
            "Hong Kong": "asia",
            "Sri Lanka": "asia",
            "Laos": "asia",
            "Philippines": "asia",
            "Singapore": "asia",
            "Indonesia": "asia",
            "Vietnam": "asia",
            "Malaysia": "asia",
            "Thailand": "asia",
            "Cambodia": "asia",
            "Israel": "asia",
            "Turkey": "asia",
            "Kazakhstan": "asia",
            "Uzbekistan": "asia",
            "Macao": "asia",
            "Maldives": "asia",
            "Georgia": "asia",
            "Azerbaijan": "asia",
            "Egypt": "wishlist",
            "Madagascar": "wishlist",
            "Mauritius": "wishlist",
            "Tanzania": "wishlist",
            "Kenya": "wishlist",
            "Ethiopia": "wishlist",
            "Qatar": "wishlist",
            "China": "wishlist",
            "South Korea": "wishlist",
            "Papua New Guinea": "wishlist",
            "Australia": "wishlist",
            "New Zealand": "wishlist",
            "Canada": "wishlist",
            "USA": "wishlist",
            "Brazil": "wishlist",
            "Argentina": "wishlist",
            "Chile": "wishlist",
            "Colombia": "wishlist",
            "Venezuela": "wishlist",
            "Panama": "wishlist",
            "Mexico": "wishlist",
            "Guatemala": "wishlist",
            "Peru": "wishlist",
            "Ecuador": "wishlist",
            "Bolivia": "wishlist",
            "Cuba": "wishlist",
            "Puerto Rico": "wishlist",
        };

        // Build continentMapping from countryToContinentMap
        for (const [country, continent] of Object.entries(countryToContinentMap)) {
            if (!continentMapping[continent]) {
                continentMapping[continent] = [];
            }
            // Only add countries that actually exist in locations
            if (locations[country]) {
                continentMapping[continent].push(country);
            }
        }

        function getContinent(country) {
            return countryToContinentMap[country] || 'unknown';
        }

        const continentFilters = document.querySelectorAll('.map-filter-button');
        const continentFilterButtons = Array.from(continentFilters);

        // Group markers by continent for different icons
        const continentColors = {
            'asia': '#4CAF50',
            'europe': '#2196F3',
            'wishlist': '#E91E63'
        };
        
        // Create markers with different icons based on continent
        const markers = [];
        let i = 0;
        for (const country in locations) {
            for (const location of locations[country]) {
                const continent = getContinent(country);
                const isWishlist = location.wishlist === true;
                
                const marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.title,
                    icon: isWishlist ? {
                        url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
                                <text x="16" y="24" font-size="24" text-anchor="middle" fill="#FFD700">🌟</text>
                            </svg>
                        `),
                        scaledSize: new google.maps.Size(32, 32),
                        anchor: new google.maps.Point(16, 16)
                    } : {
                        path: google.maps.SymbolPath.CIRCLE,
                        fillColor: continentColors[continent] || '#FF0000',
                        fillOpacity: 0.8,
                        strokeWeight: 1,
                        strokeColor: '#FFFFFF',
                        scale: 8
                    },
                    animation: google.maps.Animation.DROP // Add animation to markers
                });

                // Custom info window content
                const infoWindow = new google.maps.InfoWindow({
                    content: `
                        <div class="custom-info-window">
                            <div class="info-location-name">${location.title} ${isWishlist ? '🌟' : ''}</div>
                            <div class="info-continent continent-${continent}">${continent ? continent.charAt(0).toUpperCase() + continent.slice(1) : 'Unknown'}</div>
                        </div>
                    `,
                    maxWidth: 250
                });

                marker.addListener('click', () => {
                    infoWindow.open(map, marker);
                });
                
                markers.push(marker);
            }
        }

        // Add markers to clusters for better performance and visuals
        const markerCluster = new markerClusterer.MarkerClusterer({
            map,
            markers,
            gridSize: 50,
            maxZoom: 15,
            minimumClusterSize: 2,
            styles: [
                {
                    textColor: 'white',
                    url: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m1.png',
                    width: 53,
                    height: 53
                }
            ]
        });

        // Filter markers by continent
        continentFilterButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Update active button UI
                continentFilterButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Get filter value (all, asia, europe, wishlist)
                const filter = button.getAttribute('data-filter');
                console.log("Filtering by:", filter); // Debug log
                
                // Filter markers based on the selected continent
                let markerIndex = 0;
                for (const country in locations) {
                    for (const location of locations[country]) {
                        const continent = getContinent(country);
                        const isWishlist = location.wishlist === true;
                        console.log(country, "Continent:", continent, "Wishlist:", isWishlist); // Debug log
                        
                        let shouldShow = false;
                        if (filter === 'all') {
                            shouldShow = true;
                        } else if (filter === 'wishlist') {
                            shouldShow = isWishlist;
                        } else {
                            shouldShow = continent === filter && !isWishlist;
                        }
                        
                        if (shouldShow) {
                            markers[markerIndex].setVisible(true);
                        } else {
                            markers[markerIndex].setVisible(false);
                        }
                        markerIndex++;
                    }
                }
                
                // Update clusters after filtering
                markerCluster.clearMarkers();
                markerCluster.addMarkers(markers.filter(m => m.getVisible()));
            });
        });

        // Add heat map option
        const heatMapButton = document.createElement('button');
        heatMapButton.className = 'map-filter-button';
        heatMapButton.innerHTML = '<i class="fas fa-fire"></i> Heat Map';
        document.getElementById('map-controls').appendChild(heatMapButton);
        
        let heatmap = null;
        
        heatMapButton.addEventListener('click', function() {
            if (heatmap) {
                heatmap.setMap(null);
                heatmap = null;
                this.classList.remove('active');
            } else {
                const heatmapData = markers.map(marker => {
                    return {
                        location: new google.maps.LatLng(marker.getPosition().lat(), marker.getPosition().lng()),
                        weight: 1
                    };
                });
                
                heatmap = new google.maps.visualization.HeatmapLayer({
                    data: heatmapData,
                    map: map,
                    radius: 20
                });
                
                this.classList.add('active');
            }
        });

        // Draw travel path - connect markers chronologically for visual travel journey
        // Exclude wishlist locations from the travel path
        const travelPathLocations = [];
        for (const country in locations) {
            for (const location of locations[country]) {
                if (!location.wishlist) {
                    travelPathLocations.push({lat: location.lat, lng: location.lng});
                }
            }
        }
        
        const flightPath = new google.maps.Polyline({
            path: travelPathLocations,
            geodesic: true,
            strokeColor: '#FF0000',
            strokeOpacity: 0.7,
            strokeWeight: 2
        });

        // Add checkbox to toggle travel path
        const mapContainer = document.getElementById('map');
        const pathToggle = document.createElement('div');
        pathToggle.innerHTML = `
            <div style="position: absolute; bottom: 30px; left: 10px; z-index: 100; background: white; padding: 10px; border-radius: 5px; box-shadow: 0 2px 6px rgba(0,0,0,0.3);">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="checkbox" id="path-toggle"> 
                    <span style="margin-left: 5px;">Show travel path</span>
                </label>
            </div>
        `;
        mapContainer.appendChild(pathToggle);
        
        document.getElementById('path-toggle').addEventListener('change', function() {
            if (this.checked) {
                flightPath.setMap(map);
            } else {
                flightPath.setMap(null);
            }
        });
    }
</script>

</body>
</html>